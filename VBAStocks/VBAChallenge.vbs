Sub VBAChallenge():Dim ticker As StringDim number_tickers As IntegerDim lastRow As LongDim open_price As DoubleDim close_price As DoubleDim yearly_change As DoubleDim percentage_change As DoubleDim total_stock_volume As DoubleDim maxLine As IntegerDim minLine As IntegerDim maxrow As IntegerDim maxnumber As DoubleDim minnumber As DoubleDim maxvolume As DoubleFor Each ws In Worksheets    ws.Activate    lastRow = ws.Cells(Rows.Count, "A").End(xlUp).Row    ws.Cells(1, 9).Value = "Ticker"    ws.Cells(1, 10).Value = "Yearly Change"    ws.Cells(1, 11).Value = "Percent Change"    ws.Cells(1, 12).Value = "Total Stock Volume"        number_tickers = 0    ticker = ""    yearly_change = 0    open_price = 0    percentage_change = 0    total_stock_volume = 0        maxnumber = 0    minnumber = 0    maxvolume = 0        For I = 2 To lastRow        ticker = Cells(I, 1).Value                If open_price = 0 Then            open_price = Cells(I, 3).Value        End If                total_stock_volume = total_stock_volume + Cells(I, 7).Value                If Cells(I + 1, 1).Value <> ticker Then                        number_tickers = number_tickers + 1            Cells(number_tickers + 1, 9) = ticker                        close_price = Cells(I, 6)                        yearly_change = close_price - open_price                        Cells(number_tickers + 1, 10).Value = yearly_change                        If yearly_change > 0 Then                Cells(number_tickers + 1, 10).Interior.Color = RGB(0, 255, 0)                        ElseIf yearly_change < 0 Then                Cells(number_tickers + 1, 10).Interior.Color = RGB(255, 0, 0)                        End If                        If open_price = 0 Then                percentage_change = 0            Else                percentage_change = (yearly_change / open_price)            End If                        Cells(number_tickers + 1, 11).Value = Format(percentage_change, "Percent")                        open_price = 0                        Cells(number_tickers + 1, 12).Value = total_stock_volume                        total_stock_volume = 0        End If            Next I        ws.Cells(1, 16).Value = "Ticker"    ws.Cells(2, 15).Value = "Greatest % Increase"    ws.Cells(3, 15).Value = "Greatest % Decrease"    ws.Cells(4, 15).Value = "Greatest Total Value"    ws.Cells(1, 17).Value = "Value"    Range("O2").EntireColumn.AutoFit        lastRow = ws.Cells(Rows.Count, "I").End(xlUp).Row        For I = 2 To lastRow        If ws.Cells(I, 11) > maxnumber Then            maxnumber = ws.Cells(I, 11).Value            maxLine = I        End If    Next I    ws.Cells(2, 16).Value = ws.Cells(maxLine, 9).Value    ws.Cells(2, 17).Value = ws.Cells(maxLine, 11).Value    ws.Cells(2, 17).NumberFormat = "0.00%"        For I = 2 To lastRow        If ws.Cells(I, 11) < minnumber Then            minnumber = ws.Cells(I, 11).Value            minLine = I        End If    Next I    ws.Cells(3, 16).Value = ws.Cells(minLine, 9).Value    ws.Cells(3, 17).Value = ws.Cells(minLine, 11).Value    ws.Cells(3, 17).NumberFormat = "0.00%"        For I = 2 To lastRow        If ws.Cells(I, 12) > maxvolume Then            maxvolume = ws.Cells(I, 12).Value            maxrow = I        End If    Next I    ws.Cells(4, 16).Value = ws.Cells(maxrow, 9).Value    ws.Cells(4, 17).Value = ws.Cells(maxrow, 12).Value   Next wsEnd Sub